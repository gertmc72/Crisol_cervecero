{% extends "base.html" %}

{% block title %}{{ beer.name }} - Crisol Cervecero{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
    <a href="{% url 'beer_list' %}" style="color: #666; text-decoration: none;">‚Üê Volver a cervezas</a>
</div>

<h1>üç∫ {{ beer.name }}</h1>

<div class="card" style="margin-bottom: 20px;">
    <p><strong>Estilo:</strong> {{ beer.style }}</p>
    <p><strong>ABV:</strong> {{ beer.abv|default:"N/A" }}%</p>
    <p><strong>Calificaci√≥n promedio:</strong> ‚≠ê {{ beer.avg_rating }}</p>
    <p><strong>Cervecer√≠a:</strong> {{ beer.brewery.name }}</p>
</div>

<div style="margin-bottom: 20px;">
    {% if user.is_authenticated %}
        <a href="{% url 'create_review' beer.id %}" class="btn">‚úçÔ∏è Crear Rese√±a</a>
        <a href="{% url 'threads_list' %}" class="btn btn-secondary" style="margin-left: 10px;">üí¨ Ver hilos ({{ threads_count }})</a>
    {% else %}
        <p style="padding: 15px; background-color: #fff3cd; border: 1px solid #ffc107; border-radius: 4px;">
            üí° <a href="{% url 'login' %}?next={{ request.path }}">Inicia sesi√≥n</a> para crear una rese√±a o participar en los hilos.
        </p>
    {% endif %}
</div>

<h2>üìù Rese√±as</h2>

{% if reviews %}
    {% for r in reviews %}
        <div class="card" style="margin-top: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span style="font-weight: bold;">{{ r.user_name }}</span>
                <span style="color: #999; font-size: 12px;">{{ r.created_at|date:"d/m/Y H:i" }}</span>
            </div>
            {% if r.brand or r.brewery_name %}
                <div style="margin-bottom: 8px; font-size: 14px; color: #666;">
                    {% if r.brand %}
                        <strong>Marca:</strong> {{ r.brand }}
                    {% endif %}
                    {% if r.brewery_name %}
                        {% if r.brand %} ‚Ä¢ {% endif %}
                        <strong>Cervecer√≠a:</strong> {{ r.brewery_name }}
                    {% endif %}
                </div>
            {% endif %}
            <div style="white-space: pre-wrap; margin-bottom: 10px;">{{ r.comment|linebreaksbr }}</div>
            {% if r.photos_list %}
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                    {% for photo in r.photos_list %}
                        <img src="{{ photo.photo.url }}" alt="Foto de rese√±a" style="max-width: 200px; max-height: 200px; border-radius: 4px; border: 1px solid #e0e0e0; cursor: pointer;" onclick="window.open(this.src, '_blank')">
                    {% endfor %}
                </div>
            {% endif %}
            <div style="margin-top: 10px; font-size: 12px; color: #999;">
                <strong>Calificaciones:</strong> Aroma: {{ r.aroma }}/5 ‚Ä¢ Sabor: {{ r.sabor }}/5 ‚Ä¢ Cuerpo: {{ r.cuerpo }}/5 ‚Ä¢ Apariencia: {{ r.apariencia }}/5
            </div>
        </div>
    {% endfor %}
{% else %}
    <p style="margin-top: 20px; color: #999; font-style: italic;">Sin rese√±as a√∫n.</p>
{% endif %}
{% endblock %}
